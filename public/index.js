!function(){"use strict";function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function a(t,a){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return e(t,a);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,a):void 0}}(t))||a&&t&&"number"==typeof t.length){n&&(t=n);var o=0,s=function(){};return{s:s,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){l=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(l)throw i}}}}const n=()=>{let t=document.querySelector(".loader");t&&(t.style.display="none")},o=t=>{let e=new URLSearchParams(window.location.search),a=e.get("sid")?e.get("sid"):"",n=-1==t.indexOf("?")?"?sid="+a:"&sid="+a;return t+n},s=()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},i=()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},r=t=>{let e=t+"=",a=decodeURIComponent(document.cookie).split(";");for(let t=0;t<a.length;t++){let n=a[t];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""};r("kenzap_api_key"),r("locale")&&r("locale"),(()=>{let t=localStorage.hasOwnProperty("header")&&localStorage.hasOwnProperty("header-version")?localStorage.getItem("header-version"):0,e=window.location.hostname+"/"+i()+"/"+r("locale");e!=r("check")&&(t=0,console.log("refresh")),((t,e,a)=>{let n="";if(a){let t=new Date;t.setTime(t.getTime()+24*a*60*60*1e3),n=";expires="+t.toUTCString()}document.cookie=t+"="+(escape(e)||"")+n+";path=/;domain=.kenzap.cloud"})("check",e,5)})(),r("kenzap_token"),i();const l=t=>{if(console.log(t),isNaN(t.code)){let e=t;try{e=JSON.stringify(e)}catch(t){}let a=new URLSearchParams;return a.append("cmd","report"),a.append("sid",i()),a.append("token",r("kenzap_token")),a.append("data",e),fetch("https://api-v1.kenzap.cloud/error/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded"},body:a}),void alert("Can not connect to Kenzap Cloud")}if(401===t.code){if(-1!=window.location.href.indexOf("localhost"))return void alert(t.reason);location.href="https://auth.kenzap.com/?app=65432108792785&redirect="+window.location.href}else alert(t.reason)},c=(t,e)=>{if(document.querySelector(t))for(let a of document.querySelectorAll(t))a.removeEventListener("click",e,!0),a.addEventListener("click",e,!0)},d=t=>{if(!document.querySelector(".toast")){let t='\n        <div class="position-fixed bottom-0 p-2 m-4 end-0 align-items-center">\n            <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000">\n                <div class="d-flex">\n                    <div class="toast-body"></div>\n                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n                </div>\n            </div>\n        </div>';document.querySelector("body > div")&&document.querySelector("body > div").insertAdjacentHTML("afterend",t)}let e=new bootstrap.Toast(document.querySelector(".toast"));document.querySelector(".toast .toast-body").innerHTML=t,e.show()};var p=function(t){return document.createElement("div").appendChild(document.createTextNode(t)).parentNode.innerHTML},u=function(t){t=(t=t.replace(/(?:\r\n|\r|\n)/g,"")).replace(/\s+/g," ").trim();var e=document.createElement("textarea");e.innerHTML=t;var a=0===e.childNodes.length?"":e.childNodes[0].nodeValue;return a=a.replace(/>\s/g,">")},m=function(){var t=new URLSearchParams(window.location.search),e=t.get("page")?t.get("page"):1;return parseInt(e)},h=function(t,e){if(void 0!==t){var n=t.limit+t.offset;n>t.total_records&&(n=t.total_records),document.querySelector("#listing_info").innerHTML="Showing "+(1+t.offset)+" to "+n+" of "+t.total_records+" entries";var o=Math.ceil(t.total_records/t.limit);document.querySelector("#listing_paginate").style.display=o<2?"none":"block";var s=m(),i='<ul class="pagination d-flex justify-content-end pagination-flat">';i+='<li class="paginate_button page-item previous" id="listing_previous"><a href="#" aria-controls="order-listing" data-type="prev" data-page="0" tabindex="0" class="page-link"><span aria-hidden="true">&laquo;</span></li>';for(var r=0;r<o;)(++r>=s-3&&r<=s||r<=s+3&&r>=s)&&(i+='<li class="paginate_button page-item '+(s==r?"active":"")+'"><a href="#" aria-controls="order-listing" data-type="page" data-page="'+r+'" tabindex="0" class="page-link">'+(s==r?"..":r)+"</a></li>");i+='<li class="paginate_button page-item next" id="order-listing_next"><a href="#" aria-controls="order-listing" data-type="next" data-page="2" tabindex="0" class="page-link"><span aria-hidden="true">&raquo;</span></a></li>',i+="</ul>",document.querySelector("#listing_paginate").innerHTML=i;var l,c=a(document.querySelectorAll(".page-link"));try{var d=function(){var t=l.value;t.addEventListener("click",(function(a){var n,s,i,r,l,c=parseInt(m()),d=c;switch(t.dataset.type){case"prev":(c-=1)<1&&(c=1);break;case"page":c=t.dataset.page;break;case"next":(c+=1)>o&&(c=o)}if(window.history.replaceState){var p=window.location.search;n="page",s=c,i=p,r=new RegExp("([?;&])"+n+"[^&;]*[;&]?"),p=((l=i.replace(r,"$1").replace(/&$/,"")).length>2?l+"&":"?")+(s?n+"="+s:""),window.history.replaceState("kenzap-cloud",document.title,window.location.pathname+p)}return d!=c&&e(),a.preventDefault(),!1}))};for(c.s();!(l=c.n()).done;)d()}catch(t){c.e(t)}finally{c.f()}}else document.querySelector("#listing_info").innerHTML="no records to display"},f=function(t){switch(t=parseInt(t)){case 0:return'<div class="badge bg-warning text-dark fw-light">Draft</div>';case 1:return'<div class="badge bg-primary fw-light">Published</div>';case 3:return'<div class="badge bg-secondary fw-light">Unpublished</div>';default:return'<div class="badge bg-secondary fw-light">Drafts</div>'}},g=function(t){var e="";return t&&t.forEach((function(t){e+='<div class="badge bg-light text-dark fw-light me-1">'+t+"</div>"})),e},v=function(t){for(var e="",a="0123456789",n=a.length,o=0;o<t;o++)e+=a.charAt(Math.floor(Math.random()*n));return e},b=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.quill=t,this.handleDrop=this.handleDrop.bind(this),this.handlePaste=this.handlePaste.bind(this),this.quill.root.addEventListener("drop",this.handleDrop,!1),this.quill.root.addEventListener("paste",this.handlePaste,!1)}var a,n,o;return a=e,n=[{key:"handleDrop",value:function(t){if(t.preventDefault(),t.dataTransfer&&t.dataTransfer.files&&t.dataTransfer.files.length){if(console.log("handleDrop"),document.caretRangeFromPoint){var e=document.getSelection(),a=document.caretRangeFromPoint(t.clientX,t.clientY);e&&a&&e.setBaseAndExtent(a.startContainer,a.startOffset,a.startContainer,a.startOffset)}this.readFiles(t.dataTransfer.files,this.insert.bind(this))}}},{key:"handlePaste",value:function(t){var e=this;t.clipboardData&&t.clipboardData.items&&t.clipboardData.items.length&&this.readFiles(t.clipboardData.items,(function(t){var a=e.quill.getSelection();console.log("handlePaste"),a||setTimeout((function(){return e.insert(t)}),0)}))}},{key:"insert",value:function(t){var e=this;console.log("insert"),console.log(t);var a=v(24),n=s(),o=this.dataURLtoFile(t,a),i=new FormData;i.append("id",a),i.append("sid",n),i.append("pid",0),i.append("key","image"),i.append("sizes","1200|720|100"),i.append("file",o),i.append("slug","post-"+a),i.append("token",r("kenzap_token")),fetch("https://api-v1.kenzap.cloud/upload/",{body:i,method:"post"}).then((function(t){return t.json()})).then((function(t){if(t.success){var o=CDN+"/S"+n+"/post-"+a+"-720.jpeg",s=(e.quill.getSelection()||{}).index||e.quill.getLength();e.quill.insertEmbed(s,"image",o,"user")}}))}},{key:"dataURLtoFile",value:function(t,e){for(var a=t.split(","),n=a[0].match(/:(.*?);/)[1],o=atob(a[1]),s=o.length,i=new Uint8Array(s);s--;)i[s]=o.charCodeAt(s);return new File([i],e,{type:n})}},{key:"readFiles",value:function(t,e){[].forEach.call(t,(function(t){if(t.type.match(/^image\/(gif|jpe?g|a?png|svg|webp|bmp|vnd\.microsoft\.icon)/i)){var a=new FileReader;a.onload=function(t){console.log("readFiles"),console.log(t.target.result),e(t.target.result)};var n=t.getAsFile?t.getAsFile():t;n instanceof Blob&&a.readAsDataURL(n)}}))}}],n&&t(a.prototype,n),o&&t(a,o),Object.defineProperty(a,"prototype",{writable:!1}),e}(),y=function(t){if(!t)throw new Error("DOM Element is undifined! Please choose HTML target element.");var e,a,n,o,s,i,r=t;function l(){e.innerHTML="",o.forEach((function(t,a){if(t){var n=document.createElement("li");n.innerHTML="".concat(t," <a>&times;</a>"),n.querySelector("a").addEventListener("click",(function(){var t;t=a,o=o.filter((function(e,a){return a!==t&&e})),l()})),e.appendChild(n)}})),r.setAttribute("data-simple-tags",o.toString())}n=(n=r.getAttribute("data-simple-tags")).split(","),o=n.map((function(t){return t.trim()})),s=document.createElement("ul"),(i=document.createElement("input")).setAttribute("placeholder","new entry"),r.appendChild(s),r.appendChild(i),e=r.firstElementChild,a=r.lastElementChild,l(),a.addEventListener("keyup",(function(t){var e=this.value.trim();(e.includes(",")||13===t.keyCode)&&(""!==e.replace(",","")&&o.push(e.replace(",","")),this.value=""),l()}))},S={state:{firstLoad:!0,post:{},response:null,API_key:null,limit:10,quill:null,mode:"quill"},init:function(){S.getData()},getData:function(){S.state.firstLoad&&(()=>{let t=document.querySelector(".loader");t&&(t.style.display="block")})();var t=document.querySelector(".search-cont input")?document.querySelector(".search-cont input").value:"";fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain","Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":s()},body:JSON.stringify({query:{keys:{type:"api-key",keys:["public"]},user:{type:"authenticate",fields:["id","avatar"]},locale:{type:"locale",id:r("lang")},posts:{type:"find",key:"blog-post",fields:["_id","id","kid","img","slug","author","status","tags","title","updated","created"],limit:S.state.limit,offset:t.length>0?0:m()*S.state.limit-S.state.limit,search:{field:"title",s:t},sortby:{field:"created",order:"DESC"}}}})}).then((function(t){return t.json()})).then((function(t){n(),t.success?(S.state.response=t,(t=>{if(t.header&&localStorage.setItem("header",t.header),!document.querySelector("#k-script")){let t=document.createElement("div");t.innerHTML=localStorage.getItem("header"),t=t.firstChild,document.body.prepend(t),Function(document.querySelector("#k-script").innerHTML).call("test")}t.locale&&window.i18n.init(t.locale)})(t),S.loadPageStructure(),S.renderPage(t),S.initRichText(t),S.initListeners(),S.initPagination(t),S.initFooter(),S.state.firstLoad=!1):l(t)})).catch((function(t){console.error("Error:",t)}))},authUser:function(t){t.user&&t.user.success},loadPageStructure:function(){S.state.firstLoad&&(document.querySelector("#contents").innerHTML=function(t){return'\n    <div class="container">\n\n        <div class="d-sm-flex justify-content-between bd-highlight mb-3">\n            <nav class="bc" aria-label="breadcrumb"></nav>\n            <button class="btn btn-primary btn-add mt-2 mt-sm-0" data-postid="0" type="button">'.concat(t("Add article"),'</button>\n        </div>\n\n        <div class="row">\n            <div class="col-md-12 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card">\n                <div class="card border-white shadow-sm">\n                    <div class="card-body">\n                        <div class="no-footer">\n                            <div class="row">\n                                <div class="col-sm-12">\n                                    <div class="table-responsive">\n                                        <table\n                                            class="table table-hover table-borderless align-middle table-striped table-p-list"\n                                            style="min-width: 800px;">\n                                            <thead>\n\n                                            </thead>\n                                            <tbody>\n\n                                            </tbody>\n                                        </table>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div class="row">\n                                <div class="col-sm-12 col-md-5">\n                                    <div class="dataTables_info mt-3 text-secondary fw-lighter" id="listing_info"\n                                        role="status" aria-live="polite">&nbsp;</div>\n                                </div>\n                                <div class="col-sm-12 col-md-7">\n                                    <div class="dataTables_paginate paging_simple_numbers mt-3" id="listing_paginate">\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class="modal" tabindex="-1">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title"></h5>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary btn-modal"></button>\n                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n\n    \n    ')}(__))},renderPage:function(t){if(S.state.firstLoad&&((t=>{let e='<ol class="breadcrumb mt-2 mb-0">';for(let a of t)void 0===a.link?e+=`<li class="breadcrumb-item">${a.text}</li>`:e+=`<li class="breadcrumb-item"><a href="${a.link}">${a.text}</a></li>`;e+="</ol>",document.querySelector(".bc").innerHTML=e})([{link:o("https://dashboard.kenzap.cloud"),text:__("Dashboard")},{text:__("Blog posts")}]),document.querySelector(".table thead").innerHTML='\n                <tr>\n                    <th>\n                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#212529" class="bi justify-content-end bi-search mb-1" viewBox="0 0 16 16" >\n                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>\n                        </svg>\n                    </th>\n                    <th>\n                        <div class="search-cont input-group input-group-sm mb-0 justify-content-start d-none">     \n                            <input type="text" placeholder="'.concat(__("Search articles"),'" class="form-control border-top-0 border-start-0 border-end-0 rounded-0" aria-label="').concat(__("Search products"),'" aria-describedby="inputGroup-sizing-sm" style="max-width: 200px;">\n                        </div>\n                        <span>').concat(__("Title"),"</span>\n                    </th>\n                    <th>").concat(__("Status"),"</th>\n                    <th>").concat(__("Tags"),"</th>\n                    <th>").concat(__("Updated"),'</th>\n                    <th class="text-end pe-3"></th>\n                </tr>')),0!=t.posts.length){s();var e,a,n,i,r,l="";for(var c in t.posts){var d="https://cdn.kenzap.com/loading.png";t.posts[c].img||(t.posts[c].img=[]),t.posts[c].img[0]&&(d=t.posts[c].img[0].replace("-720.jpeg","-100.jpeg")+"?"+t.posts[c].updated),l+='\n                <tr>\n                    <td>\n                        <div class="timgc ">\n                            <a class="edit-post " href="#"><img src="'.concat(d,'" data-srcset="').concat(d,'" class="img-fluid rounded" alt="').concat(__("Product placeholder"),'" srcset="').concat(d,'" ></a>\n                        </div>\n                    </td>\n                    <td class="destt" style="max-width:250px;min-width:250px;">\n                        <div class="mb-2 mt-2"> \n                            <a class="post-title edit-post" data-id="').concat(t.posts[c]._id,'" href="#" >').concat(t.posts[c].title,'<i style="color:#9b9b9b;font-size:15px;margin-left:8px;" title="').concat(__("Edit product"),'" class="mdi mdi-pencil menu-icon edit-page"></i></a>\n                        </div>\n                    </td>\n                    <td>\n                        <span class="edit-settings" data-i="').concat(c,'" data-id="').concat(t.posts[c]._id,'" data-title="').concat(t.posts[c].title,'">').concat(f(t.posts[c].status),'</span>\n                    </td>\n                    <td style="max-width:200px;">\n                        <span class="edit-settings" data-i="').concat(c,'" data-id="').concat(t.posts[c]._id,'" data-title="').concat(t.posts[c].title,'">').concat(g(t.posts[c].tags),"</span>\n                    </td>\n                    <td>\n                        <span>").concat((e=t.posts[c].updated,a=void 0,n=void 0,i=void 0,r=void 0,a=new Date(1e3*e),n=a.getFullYear(),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a.getMonth()],r=a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),r+" "+i+" "+n),'</span>\n                    </td>\n                    <td class="d-none"> \n                        <a href="#" data-id="').concat(t.posts[c]._id,'" class="remove-post text-danger ">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">\n                                <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>\n                                <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>\n                            </svg>\n                        </a>\n                        <i title="').concat(__("Remove this product"),'" data-key="').concat(t.posts[c].id,'" class="mdi mdi-trash-can-outline list-icon remove-post"></i>\n                    </td>\n                    <td style="text-align:right;" class="">\n                        <button class="btn btn-sm dropdown-toggle" type="button" id="dropdownMenuSizeButton').concat(c,'" data-i="').concat(c,'" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">').concat(__("Option"),'</button>\n                        <div class="dropdown-menu" aria-labelledby="dropdownMenuSizeButton').concat(c,'" >\n                            <a class="dropdown-item preview" href="').concat("https://kenzap.com/post/"+t.posts[c].slug,'" target="_blank" data-id="').concat(t.posts[c]._id,'" >').concat(__("Preview"),'</a>\n                            <a class="dropdown-item edit-post" href="#" target="_self" data-id="').concat(t.posts[c]._id,'" >').concat(__("Edit"),'</a>\n                            <a class="dropdown-item rename-layout d-none" href="#" data-toggle="modal" data-id="').concat(t.posts[c]._id,'" >').concat(__("Preview"),'</a>\n                            <a class="dropdown-item edit-settings" href="#" data-toggle="modal" data-i="').concat(c,'" data-id="').concat(t.posts[c]._id,'" data-title="').concat(t.posts[c].title,'">').concat(__("Settings"),'</a>\n                            <a class="dropdown-item duplicate-layout d-none" href="#" data-toggle="modal" data-id="').concat(t.posts[c]._id,'" >').concat(__("Duplicate"),'</a>\n                            <div class="dropdown-divider"></div>\n                            <a class="dropdown-item remove-post text-danger " href="#" data-toggle="modal" data-id="').concat(t.posts[c]._id,'" >').concat(__("Remove"),"</a>\n                        </div>\n                    </td>\n                </tr>")}document.querySelector(".table tbody").innerHTML=l}else document.querySelector(".table tbody").innerHTML='<tr><td colspan="6">'.concat(__("No articles to display."),"</td></tr>")},initRichText:function(){S.loadDependencies("quill-1.3.7.min.js")},initListeners:function(){c(".remove-post",S.listeners.removePost),c(".table-p-list .bi-search",S.listeners.searchProductsActivate),c(".edit-post",S.editPost),c(".edit-settings",S.editSettings),S.state.firstLoad&&(c(".btn-add",S.addPost),c(".btn-modal",S.listeners.modalSuccessBtn))},listeners:{htmlEditor:function(t){t.preventDefault(),t.currentTarget.classList.contains("enabled")?(S.state.mode="quill",d(__("HTML editor mode off")),document.querySelector(".form-editor").classList.add("d-none"),document.querySelector(".form-quill").classList.remove("d-none"),S.state.quill.container.firstChild.innerHTML=u(document.querySelector(".form-editor > pre").innerHTML),t.currentTarget.classList.remove("enabled")):(S.state.mode="editor",d(__("HTML editor mode on")),document.querySelector(".form-editor").classList.remove("d-none"),document.querySelector(".form-editor > pre").innerHTML=function(t){var e=" ".repeat(2),a=0,n="\n",o=null,s=null,i=null;t+="    ";for(var r="",l=0;l<=t.length;l++){o=s,s=t.substr(l,1),i=t.substr(l+1,1);var c="<br>"===t.substr(l,4),d="<"===s&&"/"!==i&&!c,u="<"===s&&"/"===i&&!c,m=">"===o&&"<"!==s&&a>0,h=!c&&!d&&!u&&m&&""===t.substr(l,t.substr(l).indexOf("<")).trim();c&&(r+=n,a--,l+=4),d?(r+=n+e.repeat(a),a++):u?(--a<0&&(a=0),r+=n+e.repeat(a)):(" "===s&&" "===i||s===n&&""===t.substr(l,t.substr(l).indexOf("<")).trim())&&(s=""),m&&!h&&(r+=n+e.repeat(a)),r+=s}return p(r)}(S.state.post.text),document.querySelector(".form-quill").classList.add("d-none"),t.currentTarget.classList.add("enabled"))},removePost:function(t){t.preventDefault(),confirm(__("Remove this post?"))&&fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain","Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":s()},body:JSON.stringify({query:{product:{type:"delete",key:"blog-post",id:t.currentTarget.dataset.id},action:{type:"webhook",data:[{"content-type":"application/json",url:"https://api.kenzap.com/v1/?cmd=remove_blog_post&id="+t.currentTarget.dataset.id+"&token="+S.state.response.keys.public_token}]}}})}).then((function(t){return t.json()})).then((function(t){t.success?S.getData():l(t)})).catch((function(t){console.error("Error:",t)}))},searchProductsActivate:function(t){t.preventDefault(),document.querySelector(".table-p-list thead tr th:nth-child(2) span").style.display="none",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont").classList.remove("d-none"),document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont input").focus(),((t,e)=>{if(document.querySelector(t))for(let a of document.querySelectorAll(t))a.removeEventListener("keyup",e,!0),a.addEventListener("keyup",e,!0)})(".table-p-list thead tr th:nth-child(2) .search-cont input",S.listeners.searchProducts)},searchProducts:function(t){t.preventDefault(),S.getData()},modalSuccessBtn:function(t){S.listeners.modalSuccessBtnFunc(t)},modalSuccessBtnFunc:null},addPost:function(t){S.state.post.id=t.currentTarget.dataset.postid,S.state.post.text="",S.state.post.status="1",S.loadEditor()},editPost:function(t){S.state.post.id=t.currentTarget.dataset.id,t.preventDefault(),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain","Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":s()},body:JSON.stringify({query:{post:{type:"find",key:"blog-post",fields:["_id","title","text"],id:S.state.post.id}}})}).then((function(t){return t.json()})).then((function(t){n(),t.success?(S.state.post.text=t.post.text,S.loadEditor()):l(t)})).catch((function(t){console.error("Error:",t)}))},editSettings:function(t){var e=t.currentTarget.dataset.i,n=document.querySelector(".modal"),o=new bootstrap.Modal(n);n.querySelector(".modal-dialog").classList.remove("modal-fullscreen"),n.querySelector(".modal-title").innerHTML=t.currentTarget.dataset.title,n.querySelector(".btn-primary").innerHTML=__("Update"),n.querySelector(".btn-secondary").innerHTML=__("Cancel");var i='        <div class="form-cont">            <div class="form-group mb-3 row">\n                <label for="status" class="form-label">'.concat(__("Status"),'</label>                <div class="col-sm-12 col-md-5">\n                    <div class="mt-3" role="status" aria-live="polite">\n                        <label class="form-check-label status-publish form-label">\n                            <input type="radio" class="form-check-input me-1" name="status" id="status0" value="0" ').concat("0"==S.state.response.posts[e].status?"checked":"",">\n                                ").concat(__("Draft"),'\n                        </label>\n                    </div>\n                </div>\n                <div class="col-sm-12 col-md-7">\n                    <div class="mt-3"> \n                        <label class="form-check-label status-publish form-label">\n                            <input type="radio" class="form-check-input me-1" name="status" id="status1" value="1" ').concat("1"==S.state.response.posts[e].status?"checked":"",">\n                                ").concat(__("Published"),'\n                        </label>\n                    </div>\n                </div>\n            </div>\n            <div class="form-group mb-3">                <label for="author" class="form-label">').concat(__("Author"),'</label>                <input type="text" class="form-control" id="author" autocomplete="off" placeholder="" value="').concat(S.state.response.posts[e].author?S.state.response.posts[e].author:"",'">            </div>            <div class="form-group mb-3">                <label for="p-sdesc" class="form-label">').concat(__("Tags"),'</label>                <div id="tags" class="simple-tags mb-4" data-simple-tags=""></div>\n            </div>        </div>');n.querySelector(".modal-body").innerHTML=i;var c=n.querySelector("#tags");S.state.response.posts[e].tags&&c.setAttribute("data-simple-tags",S.state.response.posts[e].tags),new y(c),S.listeners.modalSuccessBtnFunc=function(t){t.preventDefault();var i={};i.kid=S.state.response.user.id,i.author=n.querySelector("#author").value,i.status=n.querySelector('input[name="status"]:checked').value,i.tags=[];var c,d=a(n.querySelectorAll("#tags ul li"));try{for(d.s();!(c=d.n()).done;){var p=c.value;i.tags.push(p.innerHTML.replace("<a>×</a>","").trim())}}catch(t){d.e(t)}finally{d.f()}fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain","Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":s()},body:JSON.stringify({query:{product:{type:"update",key:"blog-post",id:S.state.response.posts[e]._id,data:i},action:{type:"webhook",data:[{"content-type":"application/json",url:"https://api.kenzap.com/v1/?cmd=update_blog_post&id="+S.state.response.posts[e]._id+"&token="+S.state.response.keys.public_token}]}}})}).then((function(t){return t.json()})).then((function(t){t.success?(S.getData(),o.hide()):l(t)})).catch((function(t){console.error("Error:",t)}))},o.show()},loadEditor:function(){var t=""==S.state.post.text?localStorage.getItem("article"+S.state.post.id):S.state.post.text,e=document.querySelector(".modal"),n=new bootstrap.Modal(e);e.querySelector(".modal-dialog").classList.add("modal-fullscreen"),"0"==S.state.post.id?(e.querySelector(".modal-title").innerHTML=__("Add Article"),e.querySelector(".btn-primary").innerHTML=__("Add"),e.querySelector(".btn-secondary").innerHTML=__("Cancel")):(e.querySelector(".btn-primary").innerHTML=__("Update"),e.querySelector(".btn-secondary").innerHTML=__("Cancel")),e.querySelector(".modal-title").innerHTML='        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" class="bi bi-code-square ql-html-edit" width="24" height="24" >            <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"></path>            <path d="M6.854 4.646a.5.5 0 0 1 0 .708L4.207 8l2.647 2.646a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 0 1 .708 0zm2.292 0a.5.5 0 0 0 0 .708L11.793 8l-2.647 2.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708 0z"></path>        </svg>';var o='        <div class="form-cont">            <div class="form-editor d-none" >\n                <pre class="ql-syntax" spellcheck="false"  data-gramm="false" contenteditable="true"></pre>\n            </div>\n            <div class="form-group mb-3 d-none">                <div class="form-floating mb-3">\n                    <input type="text" class="form-control" id="floatingInput" placeholder="">\n                    <label for="floatingInput">Title</label>\n                </div>\n                <label for="p-title" class="form-label d-none">'.concat(__("Title"),'</label>                <input type="text" class="form-control" id="p-title" autocomplete="off" placeholder="" value="').concat("",'">            </div>            <div class="form-quill form-group mb-3 scrolling-container">                <label for="p-sdesc" class="form-label d-none">').concat(__("Content"),'</label>                <div id="msginp" data-key="msginp" data-type="richtext" name="msginp" class="richtext-input inps"> </div>                <input type="text" class="form-control d-none" id="p-sdesc" autocomplete="off" placeholder="" value="').concat("",'">            </div>        </div>');e.querySelector(".modal-body").innerHTML=o;var i=e.querySelector(".richtext-input");i.classList.add("blog"),Quill.register("modules/imageDrop",b),S.state.quill=new Quill(i,{modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","link"],[{list:"ordered"},{list:"bullet"}],["blockquote","code-block",{background:[]}]],clipboard:{},imageDrop:!0},scrollingContainer:".scrolling-container",placeholder:__("Start typing.."),theme:"bubble"}),S.state.quill.on("text-change",(function(t,e,a){S.state.quill.container.parentElement.querySelector(".richtext-input");var n=S.state.quill.container.firstChild.innerHTML;S.state.post.text=S.cleanMsg(n),localStorage.setItem("article"+S.state.post.id,S.cleanMsg(n))})),S.state.quill.container.firstChild.innerHTML=t,c(".ql-html-edit",S.listeners.htmlEditor),document.querySelector(".ql-editor").classList.add("entry-content"),document.querySelector("html").style.fontSize="70%",e.addEventListener("hidden.bs.modal",(function(t){document.querySelector("html").style.fontSize="100%"})),S.listeners.modalSuccessBtnFunc=function(t){t.preventDefault(),"editor"==S.state.mode&&(S.state.post.text=u(document.querySelector(".form-editor > pre").innerHTML));var e={};e.title=S.state.post.text.substring(S.state.post.text.indexOf("<h1")+4,S.state.post.text.indexOf("</h1>")),e.text=S.state.post.text,e.img=[];var o=S.state.post.text.match(/<img [^>]*src="[^"]*"[^>]*>/gm);if(o){var i,c=a(o.map((function(t){return t.replace(/.*src="([^"]*)".*/,"$1")})));try{for(c.s();!(i=c.n()).done;){var p=i.value;e.img.push(p)}}catch(t){c.e(t)}finally{c.f()}console.log(e.img)}e.title.length<2?alert(__('Please provide "Heading 1" title')):"0"==S.state.post.id?(e.status="0",e.kid=S.state.response.user.id,e.slug=((t,e)=>{t=String(t),e=Object(e);var a={delimiter:"-",limit:void 0,lowercase:!0,replacements:{},transliterate:"undefined"==typeof XRegExp};for(var n in a)e.hasOwnProperty(n)||(e[n]=a[n]);var o={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Å":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Å°":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","Å":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","Å±":"u","ý":"y","þ":"th","ÿ":"y","©":"(c)","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Î":"A","Î":"E","Î":"I","Î":"O","Î":"Y","Î":"H","Î":"W","Îª":"I","Î«":"Y","α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","Î¬":"a","Î­":"e","Î¯":"i","Ï":"o","Ï":"y","Î®":"h","Ï":"w","ς":"s","Ï":"i","Î°":"y","Ï":"y","Î":"i","Å":"S","Ä°":"I","Ç":"C","Ü":"U","Ö":"O","Ä":"G","Å":"s","Ä±":"i","ç":"c","ü":"u","ö":"o","Ä":"g","Ð":"A","Ð":"B","Ð":"V","Ð":"G","Ð":"D","Ð":"E","Ð":"Yo","Ð":"Zh","Ð":"Z","Ð":"I","Ð":"J","Ð":"K","Ð":"L","Ð":"M","Ð":"N","Ð":"O","Ð":"P","Ð ":"R","Ð¡":"S","Ð¢":"T","Ð£":"U","Ð¤":"F","Ð¥":"H","Ð¦":"C","Ð§":"Ch","Ð¨":"Sh","Ð©":"Sh","Ðª":"","Ð«":"Y","Ð¬":"","Ð­":"E","Ð®":"Yu","Ð¯":"Ya","Ð°":"a","Ð±":"b","Ð²":"v","Ð³":"g","Ð´":"d","Ðµ":"e","Ñ":"yo","Ð¶":"zh","Ð·":"z","Ð¸":"i","Ð¹":"j","Ðº":"k","Ð»":"l","Ð¼":"m","Ð½":"n","Ð¾":"o","Ð¿":"p","Ñ":"r","Ñ":"s","Ñ":"t","Ñ":"u","Ñ":"f","Ñ":"h","Ñ":"c","Ñ":"ch","Ñ":"sh","Ñ":"sh","Ñ":"","Ñ":"y","Ñ":"","Ñ":"e","Ñ":"yu","Ñ":"ya","Ð":"Ye","Ð":"I","Ð":"Yi","Ò":"G","Ñ":"ye","Ñ":"i","Ñ":"yi","Ò":"g","Ä":"C","Ä":"D","Ä":"E","Å":"N","Å":"R","Š":"S","Å¤":"T","Å®":"U","Å½":"Z","Ä":"c","Ä":"d","Ä":"e","Å":"n","Å":"r","š":"s","Å¥":"t","Å¯":"u","Å¾":"z","Ä":"A","Ä":"C","Ä":"e","Å":"L","Å":"N","Ó":"o","Å":"S","Å¹":"Z","Å»":"Z","Ä":"a","Ä":"c","Ä":"e","Å":"l","Å":"n","ó":"o","Å":"s","Åº":"z","Å¼":"z","Ä":"A","Ä":"C","Ä":"E","Ä¢":"G","Äª":"i","Ä¶":"k","Ä»":"L","Å":"N","Š":"S","Åª":"u","Å½":"Z","Ä":"a","Ä":"c","Ä":"e","Ä£":"g","Ä«":"i","Ä·":"k","Ä¼":"l","Å":"n","š":"s","Å«":"u","Å¾":"z"};for(var n in e.replacements)t=t.replace(RegExp(n,"g"),e.replacements[n]);if(e.transliterate)for(var n in o)t=t.replace(RegExp(n,"g"),o[n]);var s="undefined"==typeof XRegExp?RegExp("[^a-z0-9]+","ig"):XRegExp("[^\\p{L}\\p{N}]+","ig");return t=(t=(t=(t=t.replace(s,e.delimiter)).replace(RegExp("["+e.delimiter+"]{2,}","g"),e.delimiter)).substring(0,e.limit)).replace(RegExp("(^"+e.delimiter+"|"+e.delimiter+"$)","g"),""),e.lowercase?t.toLowerCase():t})(e.title)+"-"+v(6),e.tags=[],fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain","Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":s()},body:JSON.stringify({query:{product:{type:"create",key:"blog-post",data:e}}})}).then((function(t){return t.json()})).then((function(t){t.success?(localStorage.setItem("article"+S.state.post.id,""),S.getData(),n.hide()):l(t),console.log("Success:",t)})).catch((function(t){console.error("Error:",t)}))):fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain","Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":s()},body:JSON.stringify({query:{product:{type:"update",key:"blog-post",id:S.state.post.id,data:e},action:{type:"webhook",data:[{"content-type":"application/json",url:"https://api.kenzap.com/v1/?cmd=update_blog_post&id="+S.state.post.id+"&token="+S.state.response.keys.public_token}]}}})}).then((function(t){return t.json()})).then((function(t){t.success?(localStorage.setItem("article"+S.state.post.id,""),d(__("Changes applied")),S.getData(),n.hide()):l(t)})).catch((function(t){console.error("Error:",t)}))},n.show()},loadDependencies:function(t,e){if(!document.getElementById(t)){switch(t.split(".").slice(-1)[0]){case"js":var a=document.createElement("script");a.setAttribute("src","https://static.kenzap.com/libs/"+t),a.id=t,a.onload=a.onreadystatechange=function(){this.readyState&&"complete"!=this.readyState||"function"==typeof e&&e.call()},document.body.appendChild(a);break;case"css":var n=document.getElementsByTagName("head")[0],o=document.createElement("link");o.id=t,o.rel="stylesheet",o.type="text/css",o.href="https://static.kenzap.com/libs/"+t,n.appendChild(o)}return!0}"function"==typeof e&&e.call()},imageHandler:function(t,e,a){var n=a.toBlob(),o=a.toFile(),s=new FormData;s.append("file",n),s.append("file",o),console.log("imageHandler")},cleanMsg:function(t){return t=(t=(t=(t=t.replace("<h1><br></h1>","")).replace("<h2><br></h2>","")).replace("<h3><br></h3>","")).replace("<h4><br></h4>","")},initPagination:function(t){h(t.meta,S.getData)},initFooter:function(){var t,e;t=__("Copyright © "+(new Date).getFullYear()+' <a class="text-muted" href="https://kenzap.com/" target="_blank">Kenzap</a>. All rights reserved.'),e=__("Kenzap Cloud Services - Dashboard"),document.querySelector("footer .row").innerHTML=`\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">${t}</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">${e}</span>\n    </div>`}};S.init()}();
